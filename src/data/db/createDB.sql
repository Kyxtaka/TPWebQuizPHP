CREATE TABLE USERS (
  id NUMBER(11) NOT NULL,
  username VARCHAR(255) NOT NULL,
  password VARCHAR(255) NOT NULL,
  loginTokenId NUMBER(11) NULL,
  PRIMARY KEY (id),
  FOREIGN KEY (loginTokenId) REFERENCES TOKENS(id)
);

CREATE TABLE TOKENS (
  id NUMBER(11) NOT NULL,
  token VARCHAR(255) NOT NULL,
  user_id NUMBER(11) NOT NULL,
  issed_at TIMESTAMP NOT NULL,
  expires_at TIMESTAMP NOT NULL,
  PRIMARY KEY (id),
  FOREIGN KEY (user_id) REFERENCES USERS(id)
);

CREATE TABLE ROLES (
  id NUMBER(11) NOT NULL,
  name VARCHAR(255) NOT NULL,
  PRIMARY KEY (id)
);

CREATE TABLE USER_ROLES (
  user_id NUMBER(11) NOT NULL,   
  role_id NUMBER(11) NOT NULL,
  PRIMARY KEY (user_id, role_id),
  FOREIGN KEY (user_id) REFERENCES USERS(id),
  FOREIGN KEY (role_id) REFERENCES ROLES(id)
);

CREATE TABLE QCM (
  id NUMBER(11) NOT NULL,
  uuid VARCHAR(255) NOT NULL,
  name VARCHAR(255) NOT NULL,
  type VARCHAR(255) NOT NULL,
  number_of_questions NUMBER(11) NULL,
  PRIMARY KEY (id)
);

CREATE TABLE QCMTENTATIVE (
  qcm_id NUMBER(11) NOT NULL,
  player_id NUMBER(11) NOT NULL,
  score DECIMAL(4,2) NULL,
  PRIMARY KEY (qcm_id, player_id)
);

CREATE TABLE QUESTIONS (
  id NUMBER(11) NOT NULL,
  qcm_id NUMBER(11) NOT NULL,
  question VARCHAR(255) NOT NULL,
  PRIMARY KEY (id),
  FOREIGN KEY (qcm_id) REFERENCES QCM(id)
);

CREATE TABLE ANSWERS (
  id NUMBER(11) NOT NULL,
  question_id NUMBER(11) NOT NULL,
  answer VARCHAR(255) NOT NULL,
  is_correct BOOLEAN NOT NULL,
  PRIMARY KEY (id),
  FOREIGN KEY (question_id) REFERENCES QUESTIONS(id)
);
